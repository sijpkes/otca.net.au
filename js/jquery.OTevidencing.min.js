(function(b){b.fn.evidencing=function(e){var c=this;c.append("<div class='file-viewer' style='display: none;'> </div>");var a=b("div.file-viewer");b.fn.addCheckBoxes=function(){this.find("tbody tr").each(function(c,a){0<c&&b(a).find("td").each(function(c,d){0<c&&b(d).find("p").each(function(d,a){b(a).html("<label><input type='checkbox' val='["+e+","+c+","+d+"]'> "+b(this).text()+"</label>")})})})};b.fn.removeCriteria=function(){c.find("div.popup").remove()};b.fn.showCriteria=function(){c.mydiv=this.clone();
var d=this.offset().left,a=this.offset().top;c.mydiv.hasClass("file-info")&&(c.mydiv.removeClass("file-info"),c.mydiv.addClass("popup"),c.mydiv.html(""));b.each(this.data("crit"),function(d,a){var f=a[0],e=a[1],g=a[2];console.log(a.toString());c.find("tbody tr").each(function(a,d){a==f&&b(d).find("td").each(function(a,d){a==e&&b(d).find("p").each(function(a,d){if(a==g){c.mydiv.append("<p class='criteria'>"+b(d).html()+"</p>");c.mydiv.find("input").remove()}})})})});c.append(c.mydiv);c.mydiv.offset({top:a+
10,left:d+300})};b.fn.setSelectedTab=function(){b(c.currentTableView).hide();b(c.currentTableView).css("border-width","thin");b(c.lastTabSelected).css("border-width","thin");b(c.lastTabSelected).css("border-bottom-color","#555555");this.css("border-bottom-color","rgb(244, 233, 233)");this.css("border-width","3px");this.css("border-bottom-width","9px");c.lastTabSelected=this;var a=this.data("tableid");c.currentTableView=b("table").get(a);b(c.currentTableView).css("border-width","3px");b(c.currentTableView).show()};
c.prepend("<div id='table-nav'><ul></ul></div>");b("table").each(function(a,f){0<a?b(f).hide():c.currentTableView=f;b(f).addCheckBoxes();c.find("div#table-nav ul").append("<li data-tableid="+a+">Step "+(a+1)+"</li>")});c.find("div#table-nav li").first().setSelectedTab();c.find("div#table-nav li").live("click",function(a){b(a.target).setSelectedTab()});c.prepend("<a class='button file-box'>Add evidence for the selected criteria</a><a class='button show-files'>Show evidence for the selected criteria</a>");
b(this).find(".file-box").live("click",function(){a.html("");a.html('<a href="#close" class="exit"><img src="/img/close-icon.png" alt="Close"/></a>');a.append("<p><strong>This piece of evidence will be provided for the following criteria.</strong></p>");var c="";b("input:checked").each(function(a,e){b(e).attr("checked","true");c+="<p>"+b(e).parent().html()+"</p>"});a.load("http://otaltc.net/pages/evidence-upload");a.prepend(c);a.find("div.file-box, div.show-files").remove();a.toggle(100)});b(this).find(".show-files").live("click",
function(){a.html("");a.html('<a href="#close" class="exit"><img src="/img/close-icon.png" alt="Close"/></a>');a.append('<div class=\'file-info\' data-crit=\'[["1", "1", "0"],["1", "1", "1"]]\'><img src=\'/img/audio-icon128x128.png\' alt=\'audio\'/> Interview with client on referral.</div>');a.append('<div class=\'file-info\' data-crit=\'[["1", "2", "0"],["1", "2", "1"]]\'><img src=\'/img/word-icon96x96.png\' alt=\'word document\'/> Completed referral form on client.</div>');a.toggle(100)});a.find("div.file-info").live("mouseenter",
function(a){b(a.target).showCriteria()}).live("mouseleave",function(a){console.log("mouseleave");b(a.target).removeCriteria()});b("a.button").hide();b("td input").click(function(){0<b("td input:checked").length?b("a.button").show(100):b("a.button").hide(100)});b("div.file-viewer a.exit").live("click",function(a){a.preventDefault();b("div.file-viewer").toggle(100)})}})(jQuery);